${PY_SHEBANG}
# Copyright (C) 2018 Swift Navigation Inc.
# Contact: <dev@swift-nav.com>
#
# This source is subject to the license found in the file 'LICENSE' which must
# be be distributed together with this source. All other rights reserved.
#
# THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND,
# EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED
# WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE.

from glob import glob
from setuptools import setup, Extension

import os, sys

include_dirs = ["include", "libsbp/c/include"]
sources = glob("python/*.pyx") + glob("src/*.c")

py_version = '{}{}'.format(sys.version_info[0], sys.version_info[1])

cflags = ["-Wno-unused-label", "-std=c99"]
ldflags = []
libraries = []

if os.name == 'nt':
    if py_version == '27' or py_version == '34':
      ldflags.append("-static-libgcc")
      libraries.append("python{}-gen".format(py_version))
    else:
       cflags = []

setup(
    name='libsettings',
    version="0.1.8",
    author="Swift Navigation",
    author_email="dev@swift-nav.com",
    description="Open source SwiftNav settings API library.",
    url="https://github.com/swift-nav/libsettings",
    ext_modules=[
        Extension(
            'libsettings',
            sources,
            libraries=libraries,
            include_dirs=include_dirs,
            extra_compile_args=cflags,
            extra_link_args=ldflags,
        )
    ],
)
